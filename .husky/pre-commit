#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Pre-commit hook to validate deployment before committing docs/
# This prevents committing broken builds

# Check if docs/ folder has changes
if git diff --cached --name-only | grep -q "^docs/"; then
  echo "ğŸ“¦ Detected changes in docs/ folder"
  echo "ğŸ” Running deployment validation..."
  
  # Run validation script
  bun run validate-deployment
  
  if [ $? -ne 0 ]; then
    echo ""
    echo "âŒ Deployment validation failed!"
    echo "   Please fix the errors above before committing."
    echo "   Run: bun run build && bun run validate-deployment"
    exit 1
  fi
  
  echo "âœ… Deployment validation passed!"
fi

# Run linter
echo "ğŸ” Running linter..."
bun run lint

if [ $? -ne 0 ]; then
  echo ""
  echo "âŒ Linting failed! Please fix the errors above."
  exit 1
fi

echo "âœ… Pre-commit checks passed!"

